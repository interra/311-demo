{
    "title": "Philly 311 Data Visualized",
    "backend": "cartodb",
    "dataResources": [
        {
            "resourceHandle": "byServiceName",
            "comment": "**All imported data is assumed to be in cartodb sql api return value format",
            "resourceType": "cartodb",
            "url": "https://phl.carto.com/api/v2/sql",
            "query": "?q=SELECT service_name, COUNT(cartodb_id) FROM public_cases_fc WHERE service_name NOT IN ('Information Request') GROUP BY service_name ORDER BY count DESC LIMIT 10"
        }
    ],
    "regions": [
        {
            "id": "filters",
            "children": [
                {
                    "type": "Autocomplete",
                    "filterKey": "include",
                    "label": "My Label",
                    "willFilter": ["byServiceName"],
                    "field": "service_name",
                    "multi": true,
                    "operation": "IN",
                    "options": 
			[
			    {"label": "Maintenance Residential or Commercial", "value": "Maintenance Residential or Commercial"},
			    {"label": "Rubbish/Recyclable Material Collection", "value": "Rubbish/Recyclable Material Collection"},
			    {"label": "Illegal Dumping", "value": "Illegal Dumping"},
			    {"label": "Abandoned Vehicle", "value": "Abandoned Vehicle"},
			    {"label": "Directory Assistance", "value": "Directory Assistance"},
			    {"label": "Graffiti Removal", "value": "Graffiti Removal"},
			    {"label": "Street Defect", "value": "Street Defect"},
			    {"label": "Street Light Outage", "value": "Street Light Outage"},
			    {"label": "Vacant Lot Clean-Up", "value": "Vacant Lot Clean-Up"},
			    {"label": "Vacant House or Commercial", "value": "Vacant House or Commercial"}
			]
                },
                {
                    "type": "Autocomplete",
                    "filterKey": "limit",
                    "label": "Start Date",
                    "willFilter": ["byServiceName"],
                    "field": "date",
                    "operation": ">=",
                    "options": [{"label":10, "value":10},{"label":20, "value": 20}, {"label": 30, "value": 30}]
                },
                {
                    "type": "Autocomplete",
                    "filterKey": "end_date",
                    "label": "End Date",
                    "willFilter": ["byServiceName"],
                    "field": "date",
                    "multi": true,
                    "operation": "<=",
                    "options": [{"label":"foo", "value": "foo"},{"label":"bar", "value": "bar"}, {"label": "baz", "value": "baz"}]
                },
                {
                    "type": "NeighborhoodFilter",
                    "filterKey": "neighborhood",
                    "multi": true,
                    "willFilter": ["byServiceName"]
                }
            ]
        },
        {
            "id": "region-1",
            "title": "Top Requests",
            "children": [
                {
                    "type": "Metric",
                    "key": "metric-a",
                    "dataFields": [
                        {
                            "resourceHandle": "byServiceName",
                            "field": "service_name",
                            "type": "STRING",
                            "fieldHandle": "serviceName"
                        },
                        {
                            "resourceHandle": "byServiceName",
                            "field": "count",
                            "type": "INTEGER",
                            "fieldHandle": "count"
                        }
                    ],
                    "resourceHandle": "byServiceName",
                    "background": "red",
                    "caption": "Street Defects",
                    "icon": "tree",
                    "field": "count",
                    "where": [
                        {
                            "attribute": "service_name",
                            "value": "Street Defect"
                        }
                    ],
                    "cardProps": {
                        "cardClasses": ["col-md-3"]
                    } 
                },
                {
                    "type": "Metric",
                    "key": "metric-b",
                    "dataFields": [
                        {
                            "resourceHandle": "byServiceName",
                            "field": "service_name",
                            "type": "STRING",
                            "fieldHandle": "serviceName"
                        },
                        {
                            "resourceHandle": "byServiceName",
                            "field": "count",
                            "type": "INTEGER",
                            "fieldHandle": "count"
                        }
                    ],
                    "resourceHandle": "byServiceName",
                    "background": "gold",
                    "caption": "Abandoned Vehicles",
                    "icon": "tree",
                    "field": "count",
                    "where": [
                        {
                            "attribute": "service_name",
                            "value": "Abandoned Vehicle"
                        }
                    ],
                    "cardProps": {
                        "cardClasses": ["col-md-3"]
                    } 
                },
                {
                    "type": "Metric",
                    "key": "metric-c",
                    "dataFields": [
                        {
                            "resourceHandle": "byServiceName",
                            "field": "service_name",
                            "type": "STRING",
                            "fieldHandle": "serviceName"
                        },
                        {
                            "resourceHandle": "byServiceName",
                            "field": "count",
                            "type": "INTEGER",
                            "fieldHandle": "count"
                        }
                    ],
                    "resourceHandle": "byServiceName",
                    "background": "purple",
                    "caption": "Street Light Outage",
                    "icon": "tree",
                    "field": "count",
                    "where": [
                        {
                            "attribute": "service_name",
                            "value": "Street Light Outage"
                        }
                    ],
                    "cardProps": {
                        "cardClasses": ["col-md-3"]
                    } 
                },
                {
                    "type": "Metric",
                    "key": "metric-d",
                    "dataFields": [
                        {
                            "resourceHandle": "byServiceName",
                            "field": "service_name",
                            "type": "STRING",
                            "fieldHandle": "serviceName"
                        },
                        {
                            "resourceHandle": "byServiceName",
                            "field": "count",
                            "type": "INTEGER",
                            "fieldHandle": "count"
                        }
                    ],
                    "resourceHandle": "byServiceName",
                    "background": "brown",
                    "caption": "Illegal Dumping",
                    "icon": "tree",
                    "field": "count",
                    "where": [
                        {
                            "attribute": "service_name",
                            "value": "Illegal Dumping"
                        }
                    ],
                    "cardProps": {
                        "cardClasses": ["col-md-3"]
                    } 
                }
            ]
        },
        {
            "id": "region-2",
            "children": [
                {
                    "type": "Chart",
                    "key": "chart-1",
                    "dataType": "NVD3PieChartSeries",
                    "resourceHandle": "byServiceName",
                    "x": "service_name",
                    "y": "count",
                    "limit": 50,
                    "dataFields": [
                        {
                            "resourceHandle": "byServiceName",
                            "field": "service_name",
                            "type": "STRING",
                            "fieldHandle": "serviceName"
                        },
                        {
                            "resourceHandle": "byServiceName",
                            "field": "count",
                            "type": "INTEGER",
                            "fieldHandle": "count"
                        }
                    ],
                    "settings": {
                        "type": "pieChart",
                        "labelType": "key",
                        "labelSunbeamLayout": true,
                        "showLegend": false,
                        "donut": true,
                        "donutRatio": ".65",
                        "height": "800"
                    },
                    "cardProps": {
                        "header": "Request Type",
                        "subheader": "(excluding requests for information)",
                        "cardClasses": ["col-md-6"],
                        "iconClass": "fa fa-tree"
                    }
                }
            ]
        },
        {
            "id": "region-3",
            "children": [
                {
                    "type": "Chart",
                    "key": "chart-2",
                    "dataType": "NVD3ChartSeries",
                    "resourceHandle": "byServiceName",
                    "x": "service_name",
                    "y": "count",
                    "dataFields": [
                        {
                            "resourceHandle": "byServiceName",
                            "field": "service_name",
                            "type": "STRING",
                            "fieldHandle": "serviceName"
                        },
                        {
                            "resourceHandle": "byServiceName",
                            "field": "count",
                            "type": "INTEGER",
                            "fieldHandle": "count"
                        }
                    ],
                    "settings": {
                        "type": "discreteBarChart",
                        "rotateLabels": 45,
                        "height": 1800,
                        "legend": {
                            "maxKeyLength": 1500
                        }
                    },
                    "cardProps": {
                        "header": "Request Type",
                        "subheader": "(excluding requests for information)",
                        "cardClasses": ["col-md-12"],
                        "iconClass": "fa fa-tree"
                    }
                }
            ]
        }
    ]
}
